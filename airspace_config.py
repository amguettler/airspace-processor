import re

airsport_areas = {
    'Oslo TMA' : ['STARMOEN', 'HOKKSUND', 'EGGEMOEN', 'EINA', 'SUNNVOLLEN', 'HVITTINGFOSS'],
    'Farris TMA' : ['HVITTINGFOSS', 'GVARV', 'LUNDE', 'DRANGEDAL', 'BOE', 'BØ', 
                    'TINNSJØ', 'TOKKE', 'NOTODDEN VEST'],
    'Flesland TMA' : ['GULLFJELLET GLIDER AREA', 'KVAM TRANSIT AREA'],
    'WestCoast TMA' : ['KVAM TRANSIT AREA', 'GULLFJELLET GLIDER AREA'],
    'Værnes TMA' : ['MERÅKER'],
    'Polaris CTA' : ['Bjorli', 'Lesja', 'Dovre', 'Oppdal',
                     'Vågå', 'Rondane', 'Ringebu', 'Jotunheimen'
                     ],
    }

airspace_frequencies = {
    'Airwork A' : ('118.475', 'Oslo Approach'),
    'Airwork B' : ('118.475', 'Oslo Approach'),
    'Airwork C' : ('118.475', 'Oslo Approach'),
    'Airwork E' : ('118.475', 'Oslo Approach'),
    'Airwork F' : ('118.475', 'Oslo Approach'),
    'Alta TMA' : ('120.400', 'Alta Approach'),
    'Anda TIZ' : ('119.800', 'Anda Information'),
    'Andøya TMA' : ('118.200', 'Andøya Approach'),
    'Banak CTR' : ('118.900', 'Banak Tower'),
    'Bardufoss TMA' : ('118.800', 'Bardufoss Approach'),
    'Bergen Lufthavn Flesland' : ('119.100', 'Flesland Tower'),
    'Berlevåg TIZ' : ('120.100', 'Berlevåg Information'),
    'Bodø CTR' : ('118.100', 'Bodø Tower'),
    'Bodø Lufthavn' : ('118.050', 'Bodø Tower'),
    'Bodø TMA' : ('119.700', 'Bodø Approach'),
    'Bondalen N' : ('129.325', 'Møre Approach'),
    'Bondalen S' : ('129.325', 'Møre Approach'),
    'Bringeland TIZ' : ('118.450', 'Bringeland Information'),
    'Brønnøy TIZ' : ('119.600', 'Brønnøy Information'),
    'Båtsfjord TIZ' : ('123.400', 'Båtsfjord Information'),
    'Bø' : ('124.350', 'Farris Approach'),
    'Drangedal' : ('124.350', 'Farris Approach'),
    'Ringebu' : ('124.775', 'Polaris Control'),
    'Rondane' : ('124.775', 'Polaris Control'),
    'Vågå' : ('124.775', 'Polaris Control'),
    'Jotunheimen' : ('124.775', 'Polaris Control'),
    'Østre Æra' : ('121.350', 'Østre Æra Traffic'),
    'Oppdal' : ('125.700', 'Polaris Control'),
    'Dovre' : ('125.700', 'Polaris Control'),
    'Lesja' : ('125.700', 'Polaris Control'),
    'Bjorli' : ('125.700', 'Polaris Control'),
    'Eggemoen A' : ('120.450', 'Oslo Approach'),
    'Eggemoen B' : ('120.450', 'Oslo Approach'),
    'Eina A' : ('120.450', 'Oslo Approach'),
    'Etne' : ('124.775', 'Polaris Control'),
    'Evenes CTR' : ('119.900', 'Evenes Tower'),
    'Evenes TMA' : ('118.000', 'Evenes Approach'),
    'Fagerhaug' : ('123.500', 'Fagerhaug Traffic'),
    'Farris TMA' : ('124.350', 'Farris Approach'),
    'Finnmark TIA' : ('126.700', 'Finmark Information'),
    'Flesland CTR' : ('119.100', 'Flesland Tower'),
    'Flesland TMA 2' : ('125.000', 'Flesland Approach'),
    'Flesland TMA 3' : ('125.000', 'Flesland Approach'),
    'Flesland TMA 4' : ('125.000', 'Flesland Approach'),
    'Flesland TMA 5' : ('125.000', 'Flesland Approach'),
    'Flesland TMA 6' : ('121.000', 'Flesland Approach'),
    'Flesland TMA 7' : ('121.000', 'Flesland Approach'),
    'Flesland TMA 8' : ('121.000', 'Flesland Approach'),
    'Flesland TMA 9' : ('121.000', 'Flesland Approach'),
    'Flesland TMA 10' : ('125.000', 'Flesland Approach'),
    'Flesland TMA 11' : ('125.000', 'Flesland Approach'),
    'Florø TIZ' : ('119.200', 'Florø Information'),
    'Gullfjellet Glider Area' : ('125.000', 'Flesland Approach'),
    'Gardermoen CTR' : ('120.100', 'Oslo Tower'),
#    'Gvarv' : ('124.350', 'Farris Approach'),
    'Hamar Flyplass' : ('130.275', 'Hamar Traffic'),
    'Hammerfest TIZ' : ('121.000', 'Hammerfest Information'),
    'Hammerfest TMA' : ('126.700', 'Hammerfest Approach'),
    'Hasvik TIZ' : ('119.900', 'Hasvik Information'),
    'Helgeland TMA' : ('127.900', 'Helgeland Approach'),
    'Helle TIZ' : ('120.200', 'Helle Information'),
    'Hokksund A' : ('120.450', 'Oslo Approach'),
    'Hokksund B' : ('120.450', 'Oslo Approach'),
    'Hoppfelt Bømoen' : ('123.500', 'Bømoen Traffic'),
    'Hovden TIZ' : ('118.900', 'Hovden Information'),
    'Hvittingfoss A' : ('124.350', 'Farris Approach'),
    'Hvittingfoss B' : ('124.350', 'Farris Approach'),
    'Hvittingfoss C' : ('124.350', 'Farris Approach'),
    'Hvittingfoss D' : ('124.350', 'Farris Approach'),
    'Hvittingfoss E' : ('124.350', 'Farris Approach'),
    'Jarlsberg' : ('122.300', 'Jarlsberg Traffic'),
    'Kvam Transit Area' : ('125.000', 'Flesland Approach'),
    'Karmøy CTR' : ('120.500', 'Karmøy Tower'),
    'Kirkenes CTR' : ('120.350', 'Kirkenes Tower'),
    'Kirkenes Centre TMA' : ('120.350', 'Kirkenes Approach'),
    'Kirkenes TMA' : ('120.350', 'Kirkenes Approach'),
    'Kirkenes West TMA' : ('120.350', 'Kirkenes Approach'),
    'Kjevik CTR' : ('119.950', 'Kjevik Approach'),
    'Kjevik TMA' : ('119.950', 'Kjevik Approach'),
    'Kristiansand Lufthavn Kjevik' : ('119.950', 'Kjevik Tower'),
    'Kvernberget CTR' : ('121.200', 'Kvernberget Tower'),
    'Leknes TIZ' : ('120.500', 'Leknes Information'),
    'Lesja/Bjorli Flyplass' : ('123.500', 'Bjorli Traffic'),
    'Lofoten TMA' : ('125.450', 'Lofoten Approach'),
    'Lunde' : ('124.350', 'Lunde Traffic'),
    'Mehamn TIZ' : ('121.200', 'Mehamn Information'),
    'Molde Lufthavn Årø' : ('119.950', 'Molde Information'),
    'Molde TIZ' : ('119.950', 'Molde Information'),
    'Mosjøen TIZ' : ('123.400', 'Mosjøen Information'),
    'Møre TMA' : ('119.350', 'Møre Approach'),
    'Namsos TIA' : ('118.550', 'Polaris Control'),
    'Namsos TIZ' : ('119.900', 'Namsos Information'),
    'Notodden TIZ' : ('118.800', 'Notodden Information'),
    'Notodden Vest' : ('124.350', 'Farris Approach'),
    'Oslo TMA' : ('118.475', 'Oslo Approach'),
    'Oslo TMA 2' : ('120.450', 'Oslo Approach'),
    'Oslo TMA 3' : ('118.475', 'Oslo Approach'),
    'Oslo TMA 4' : ('120.450', 'Oslo Approach'),
    'Oslo TMA 5' : ('118.475', 'Oslo Approach'),
    'Oslo TMA 6' : ('118.475', 'Oslo Approach'),
    'Oslo TMA 7' : ('118.475', 'Oslo Approach'),
    'Polaris S1' : ('118.825', 'Polaris Control'),
    'Polaris S2' : ('126.625', 'Polaris Control'),
    'Polaris S3' : ('125.050', 'Polaris Control'),
    'Polaris S4' : ('118.875', 'Polaris Control'),
    'Polaris S5' : ('127.250', 'Polaris Control'),
    'Polaris S6' : ('120.375', 'Polaris Control'),
    'Polaris S7' : ('124.775', 'Polaris Control'),
    'Polaris S8' : ('134.350', 'Polaris Control'),
    'Polaris S9' : ('120.650', 'Polaris Control'),
    'Polaris S10' : ('136.275', 'Polaris Control'),
    'Polaris S11' : ('136.275', 'Polaris Control'),
    'Polaris S12' : ('120.650', 'Polaris Control'),
    'Polaris S13' : ('134.925', 'Polaris Control'),
    'Polaris S14' : ('124.575', 'Polaris Control'),
    'Polaris S15' : ('135.675', 'Polaris Control'),
    'Polaris S16' : ('135.675', 'Polaris Control'),
    'Polaris S17' : ('124.700', 'Polaris Control'),
    'Polaris S18' : ('125.700', 'Polaris Control'),
    'Polaris S19' : ('131.100', 'Polaris Control'),
    'Rena EAST' : ('135.300', 'Rena Traffic'),
    'Rena MID' : ('135.300', 'Rena Traffic'),
    'Rena WEST' : ('135.300', 'Rena Traffic'),
    'Rognan Flyplass' : ('123.500', 'Rognan Traffic'),
    'Rygge CTR' : ('119.500', 'Rygge Tower'),
    'Rygge Flystasjon' : ('119.500', 'Rygge Tower'),
    'Røros TIA' : ('131.100', 'Polaris Control'),
    'Røros TIZ' : ('120.400', 'Røros Information'),
    'Rørvik TIZ' : ('119.800', 'Rørvik Information'),
    'Røssvoll TIZ' : ('119.950', 'Røssvoll Information'),
    'Røst TIZ' : ('119.250', 'Røst Information'),
    'Skagen TIZ' : ('120.450', 'Skagen Information'),
    'Sogn TIA' : ('124.700', 'Polaris Control'),
    'Sogndal TIZ' : ('119.300', 'Sogndal Information'),
    'Sola CTR' : ('118.350', 'Sola Tower'),
    'Sola TMA' : ('119.600', 'Sola Approach'),
    'Starmoen A' : ('118.475', 'Oslo Approach'),
    'Starmoen B1' : ('118.475', 'Oslo Approach'),
    'Starmoen B2' : ('118.475', 'Oslo Approach'),
    'Starmoen C' : ('118.475', 'Oslo Approach'),
    'Starmoen D' : ('118.475', 'Oslo Approach'),
    'Starmoen F' : ('120.450', 'Oslo Approach'),
    'Starmoen G1 Hamar' : ('118.475', 'Oslo Approach'),
    'Starmoen G2 Elverum' : ('118.475', 'Oslo Approach'),
    'Starmoen H' : ('118.475', 'Oslo Approach'),
    'Stokka TIZ' : ('120.300', 'Stokka Information'),
    'Sunnvollen' : ('120.450', 'Oslo Approach'),
    'Sørkjosen TIA' : ('126.700', 'Polaris Control'),
    'Sørkjosen TIZ' : ('119.600', 'Sørkjosen Information'),
    'Sørstokken TIZ' : ('120.200', 'Sørstokken Information'),
    'Sälen TMA' : ('124.460', 'Sälen Tower'),
    'Tinnsjø' : ('124.350', 'Farris Approach'),
    'Tokke' : ('124.350', 'Farris Approach'),
    'Torp CTR' : ('118.650', 'Torp Tower'),
    'Tromsø CTR' : ('118.300', 'Tromsø Tower'),
    'Tromsø Lufthavn' : ('118.300', 'Tromsø Tower'),
    'Tromsø TMA' : ('123.750', 'Tromsø Approach'),
    'Vadsø TIZ' : ('118.400', 'Vadsø Information'),
    'Valan TIZ' : ('119.800', 'Valan Information'),
    'Vardø TIZ' : ('122.150', 'Vardø Information'),
    'Vigra CTR' : ('119.850', 'Vigra Tower'),
    'Værnes CTR' : ('118.600', 'Værnes Tower'),
    'Værnes TMA' : ('118.600', 'Værnes Approach'),
    'Ålesund Lufthavn Vigra' : ('119.850', 'Vigra Tower'),
    'Ørland CTR' : ('118.700', 'Ørland Tower'),
    'Ørland TMA' : ('118.250', 'Ørland Approach'),
    'Østre Æra Flyplass' : ('121.350', 'Østra Æra Traffic')
}

REMOVE_AIRSPACES = [
    'EN D105 Rena',     # Replaced by our own Rena West, Mid and East
    'Bømoen Flyplass',  # Replaced by our own Hoppfelt Bømoen,
    'EN D201 Ulven'     # Already have a danger area for 'Ulven'
]

DANGER_PREFIX = re.compile(r'EN D\d\d\d ')
AIRSPACE_NAME = re.compile(r'((.*)(TMA|CTA|TIA|TIZ|CTR)\s+(\d*))')
def lookup_frequency(name):
    # Look up frequency in our table, from most specific to least
    if name in airspace_frequencies:   # We have frequency for exact airspace name
        return *airspace_frequencies[name],name
    
    if DANGER_PREFIX.match(name):
        # Try without the EN DXXX prefix
        name = name[8:]
        if name in airspace_frequencies:
            return *airspace_frequencies[name],name

    # For e.g. Farris TMA 3 West try in order: "Farris TMA 3", then "Farris TMA"
    if match := AIRSPACE_NAME.match(name):
        if match.group(1) in airspace_frequencies:
            return *airspace_frequencies[name],match.group(1)
        else:
            name = match.group(2) + match.group(3)
            return *airspace_frequencies.get(name, (None,None)),name

    return None,None,None
