import re

airsport_areas = {
    'Oslo TMA' : ['STARMOEN', 'HOKKSUND', 'EGGEMOEN', 'EINA', 'SUNNVOLLEN', 'HVITTINGFOSS'],
    'Farris TMA' : ['HVITTINGFOSS', 'GVARV', 'LUNDE', 'DRANGEDAL', 'BOE', 'BØ', 'TOKKE'],
    'Flesland TMA' : ['GULLFJELLET GLIDER AREA', 'KVAM TRANSIT AREA'],
    'WestCoast TMA' : ['KVAM TRANSIT AREA', 'GULLFJELLET GLIDER AREA'],
    'Værnes TMA' : ['MERÅKER'],
    'Polaris CTA' : ['EN D360 Bjorli', 'EN D359 Lesja', 'EN D358 Dovre', 'EN D357 Oppdal',
                     'EN D163 Vågå', 'EN D162 Rondane', 'EN D161 Ringebu', 'EN D166 Jotunheimen'
                     ],
    }

airspace_frequencies = {
    'Airwork A' : '118.475',
    'Airwork B' : '118.475',
    'Airwork C2' : '118.475',
    'Airwork E' : '118.475',
    'Airwork F' : '118.475',    
    'Alta TMA' : '120.400',
    'Anda TIZ' : '119.800',
    'Andøya TMA' : '118.200',
    'Banak CTR' : '118.900',
    'Bardufoss TMA' : '118.800',
    'Bergen Lufthavn Flesland' : '119.100',
    'Berlevåg TIZ' : '120.100',
    'Bodø CTR' : '118.100',
    'Bodø Lufthavn' : '118.050',
    'Bodø TMA' : '119.700',
    'Bondalen N' : '129.325',
    'Bondalen S' : '129.325',
    'Bringeland TIZ' : '118.450',
    'Brønnøy TIZ' : '119.600',
    'Båtsfjord TIZ' : '123.400',
    'Bø' : '124.350',
    'Bømoen Flyplass' : '123.500',
    'Drangedal' : '124.350',
    'EN D102 Østre Æra' : '121.350',
    'EN D161 Ringebu' : '124.775',
    'EN D162 Rondane' : '124.775',
    'EN D163 Vågå' : '124.775',
    'EN D166 Jotunheimen' : '124.700',
    'EN D357 Oppdal' : '125.700',
    'EN D358 Dovre' : '125.700',
    'EN D359 Lesja' : '125.700',
    'EN D360 Bjorli' : '125.700',
    'Eggemoen A' : '120.450',
    'Eggemoen B' : '120.450',
    'Eina' : '120.450',
    'Etne' : '124.775',
    'Evenes CTR' : '119.900',
    'Evenes TMA' : '118.000',
    'Fagerhaug' : '123.500',
    'Farris TMA' : '124.350',
    'Finnmark TIA' : '126.700',
    'Flesland CTR' : '119.100',
    'Flesland TMA 2' : '125.000',
    'Flesland TMA 3' : '125.000',
    'Flesland TMA 4' : '125.000',
    'Flesland TMA 5' : '125.000',
    'Flesland TMA 6' : '121.000',
    'Flesland TMA 7' : '121.000',
    'Flesland TMA 8' : '121.000',
    'Flesland TMA 9' : '121.000',
    'Flesland TMA 10' : '125.000',
    'Flesland TMA 11' : '125.000',    
    'Florø TIZ' : '119.200',
    'GULLFJELLET GLIDERAREA' : '125.000',
    'Gardermoen CTR' : '120.100',
    'Gullknapp TIZ' : '129.900',
    'Gvarv' : '124.350',
    'Hamar Flyplass' : '130.275',
    'Hammerfest TIZ' : '121.000',
    'Hammerfest TMA' : '126.700',
    'Harstad/Narvik Lufthavn  Evenes' : '118.100',
    'Hasvik TIZ' : '119.900',
    'Helgeland TMA' : '127.900',
    'Helle TIZ' : '120.200',
    'Hokksund A' : '120.450',
    'Hokksund B' : '120.450',
    'Hoppfelt Bømoen 123.500' : '123.500',
    'Hovden TIZ' : '118.900',
    'Hvittingfoss A' : '124.350',
    'Hvittingfoss B' : '124.350',
    'Hvittingfoss C' : '124.350',
    'Hvittingfoss D' : '124.350',
    'Hvittingfoss E' : '124.350',
    'Jarlsberg' : '122.300',
    'KVAM TRANSITAREA 121.0 / 123.5' : '125.000',
    'Karmøy CTR' : '120.500',
    'Kirkenes CTR' : '120.350',
    'Kirkenes Centre TMA' : '120.350',
    'Kirkenes TMA' : '120.350',
    'Kirkenes West TMA' : '120.350',
    'Kjevik CTR' : '119.950',
    'Kjevik TMA' : '119.950',
    'Kristiansand Lufthavn Kjevik' : '119.950',
    'Kvernberget CTR' : '121.200',
    'Leknes TIZ' : '120.500',
    'Lesja/Bjorli Flyplass' : '123.500',
    'Lofoten TMA' : '125.450',
    'Lunde' : '124.350',
    'Mehamn TIZ' : '121.200',
    'Molde Lufthavn Årø' : '119.950',
    'Molde TIZ' : '119.950',
    'Mosjøen TIZ' : '123.400',
    'Møre TMA' : '119.350',
    'Namsos TIA' : '118.550',
    'Namsos TIZ' : '119.900',
    'Notodden TIZ' : '118.800',
    'Oslo TMA' : '118.475',
    'Oslo TMA 2' : '120.450',
    'Oslo TMA 3' : '118.475',
    'Oslo TMA 4' : '120.450',
    'Oslo TMA 5' : '118.475',
    'Oslo TMA 6' : '118.475',
    'Oslo TMA 7' : '118.475',
    'Polaris S1' : '118.825',
    'Polaris S2' : '126.625',
    'Polaris S3' : '125.050',
    'Polaris S4' : '118.875',
    'Polaris S5' : '127.250',
    'Polaris S6' : '120.375',
    'Polaris S7' : '124.775',
    'Polaris S8' : '134.350',
    'Polaris S9' : '120.650',
    'Polaris S10' : '136.275',
    'Polaris S11' : '136.275',
    'Polaris S12' : '120.650',
    'Polaris S13' : '134.925',
    'Polaris S14' : '124.575',
    'Polaris S15' : '135.675',
    'Polaris S16' : '135.675',
    'Polaris S17' : '124.700',
    'Polaris S18' : '125.700',
    'Polaris S19' : '131.100',
    'Rena EAST 135.30' : '135.300',
    'Rena MID 135.30' : '135.300',
    'Rena WEST 135.30' : '135.300',
    'Rognan Flyplass' : '123.500',
    'Rygge CTR' : '119.500',
    'Rygge Flystasjon' : '119.500',
    'Røros TIA' : '120.400',
    'Røros TIZ' : '120.400',
    'Rørvik TIZ' : '119.800',
    'Røssvoll TIZ' : '119.950',
    'Røst TIZ' : '119.250',
    'Skagen TIZ' : '120.450',
    'Skien Lufthavn  Geiteryggen' : '119.200',
    'Sogn TIA' : '124.700',
    'Sogndal TIZ' : '119.300',
    'Sola CTR' : '118.350',
    'Sola TMA' : '119.600',
    'Starmoen A' : '118.475',
    'Starmoen B' : '118.475',
    'Starmoen C' : '118.475',
    'Starmoen D' : '118.475',
    'Starmoen F' : '120.450',
    'Starmoen G' : '118.475',
    'Starmoen H' : '118.475',
    'Stokka TIZ' : '120.300',
    'Sunnvollen' : '120.450',
    'Sørkjosen TIA' : '126.700',
    'Sørkjosen TIZ' : '119.600',
    'Sørstokken TIZ' : '120.200',
    'Tokke' : '124.350',
    'Torp CTR' : '118.650',
    'Tromsø CTR' : '118.300',
    'Tromsø Lufthavn' : '118.300',
    'Tromsø TMA' : '123.750',
    'Trondheim Lufthavn  Værnes' : '122.050',
    'Tynset' : '131,100',
    'Vadsø TIZ' : '118.400',
    'Valan TIZ' : '119.800',
    'Vardø TIZ' : '122.150',
    'Vigra CTR' : '119.850',
    'Værnes CTR' : '118.600',
    'Værnes TMA' : '118.600',
    'Ålesund Lufthavn Vigra' : '119.850',
    'Ørland CTR' : '118.700',
    'Ørland TMA' : '118.250',
    'Østre Æra Flyplass' : '135.300',
}

REMOVE_AIRSPACES = [
    'EN D105 Rena',     # Replaced by our own Rena West, Mid and East
    'Bømoen Flyplass',  # Replaced by our own Hoppfelt Bømoen
]

AIRSPACE_NAME = re.compile(r'((.*)(TMA|CTA|TIA|TIZ|CTR)\s+(\d*))')
def lookup_frequency(name):
    # Look up frequency in our table, from most specific to least
    if name in airspace_frequencies:   # We have frequency for exact airspace name
        return airspace_frequencies[name],name
    else:
        # For e.g. Farris TMA 3 West try in order: "Farris TMA 3", then "Farris TMA"
        if match := AIRSPACE_NAME.match(name):
            if match.group(1) in airspace_frequencies:
                return airspace_frequencies[name],match.group(1)
            else:
                name = match.group(2) + match.group(3)
                return airspace_frequencies.get(name, None),name

    return None,None
